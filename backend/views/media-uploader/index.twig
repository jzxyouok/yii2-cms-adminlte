
{% set baseUrl = app.params.baseUrl ~ '/' %}


<div class="box">

	<div class="box-header">
	  	<h3 class="box-title">Gallery </h3> 
	  	<div class="pull-right">
			<a href="#" class="btn btn-default btn-flat" data-toggle="modal" data-target="#modalCreateFile">Upload new file</a>
	  	</div>
		<hr>

	</div>

	<div class="box-body">

		<div class="row media-manager">

			<div class="col-md-9">
				<div class="row">
					{% for file in fileDatas %}
                      	<div class="col-xs-6 col-sm-4 col-md-3 image">
                       	 	<div class="thmb">
                       	 		<div class="btn-group fm-group" style="">
                                      <button type="button" class="btn btn-default dropdown-toggle fm-toggle" data-toggle="dropdown">
                                        <span class="caret"></span>
                                      </button>
                                      <ul class="dropdown-menu fm-menu pull-right" role="menu">
                                        <li><a href="{{ url('media-uploader/delete-file', { 'id': file.id } ) }}"><i class="fa fa-trash-o"></i> Delete</a></li>
                                      </ul>
                                  </div>
	                          	<div class="thmb-prev">
		                            <a href="#" data-image="{{ baseUrl ~ file.folder.directory ~ file.id ~ '/' ~ file.name }}" data-toggle="modal" data-target="#modalShowimage" class="imageModal" >
		                              	<img src="{{ baseUrl ~ file.folder.directory ~ file.id ~ '/thumb_' ~ file.name }}" class="img-thumbnail">
		                            </a>
	                          	</div>
                          		<h5 class="fm-title"><a href="">{{ file.name }}</a></h5>
                          		<small class="text-muted">Added: {{ file.created_at | date("M d, Y H:i A") }}</small>
                        	</div><!-- thmb -->
                      	</div><!-- col-xs-6 -->
					{% endfor %}
				</div>
			</div>

			<div class="col-md-3">
				<div class="media-manager-sidebar">
				                              
				  
				  	<div class="mb30"></div>
				  
				  	<h5 class="lg-title">Folders <a href="" class="pull-right" data-toggle="modal" data-target="#modalCreateFolder">+ Add New Folder</a></h5>
				  	<ul class="folder-list">
				  		{% for folderId, folderName in folderLists %}
					    	<li><a href=""><i class="fa fa-folder-o"></i> {{ folderName }}</a></li>
				  		{% endfor %}
				 	</ul>
				  
				  	<div class="mb30"></div>
				  
				</div>
			</div>
			<div class="col-md-12">
				<hr>
				<nav aria-label="Page navigation">

					{{ LinkPager.widget( {'pagination': filePages } ) | raw }}

				</nav>
			</div>
		</div>


	</div>


</div>

<!-- Modal -->
<div class="modal fade" id="modalCreateFolder" tabindex="-1" role="dialog" aria-labelledby="modalLabel">
  	<div class="modal-dialog" role="document">
	    <div class="modal-content">
	      	<div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="modalLabel">Create Folder</h4>
	      	</div>

			{% set form = active_form_begin( { 
				'action': 'create-folder'
			}) %}

		    <div class="modal-body">
			    {{ form.field(folderModel, 'name') | raw }}
			    
	    		{{ form.field(folderModel, 'directory', { 
	    			'template': '<div class="form-group">
	    			<label class="control-label">Directory</label>
	    			<div class="input-group">
	    				<div class="input-group-addon">' ~ app.params.baseUrl ~ '/media/</div>
	    				{input}
	    			</div>
	    			</div>'
	    		}).label(false) | raw }}
		    </div>
		    <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        <button type="submit" class="btn btn-primary">Save changes</button>
		    </div>

			{{ active_form_end() }}

	    </div>
  	</div>
</div>

<!-- Modal -->
<div class="modal fade" id="modalCreateFile" tabindex="-1" role="dialog" aria-labelledby="modalLabel">
  	<div class="modal-dialog" role="document">
	    <div class="modal-content">
	      	<div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title" id="modalLabel">Upload File</h4>
	      	</div>

			{% set form = active_form_begin( { 
				'action': 'upload-file',
				'options': { 'enctype': 'multipart/form-data' }
			}) %}

		    <div class="modal-body">
			    {{ form.field(fileModel, 'media_folder_id').dropDownList(folderLists) | raw }}
			    {{ form.field(fileModel, 'name').fileInput() | raw }}

		    </div>
		    <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        <button type="submit" class="btn btn-primary">Save changes</button>
		    </div>

			{{ active_form_end() }}

	    </div>
  	</div>
</div>

{% set script %}

{% endset %}

{{ this.registerJs(script)}}